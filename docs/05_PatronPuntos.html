<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Apuntes y ejercicios de geoestadística para forestales - 8&nbsp; Análisis de patrón de puntos en R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./06_InterpolacionEspacial.html" rel="next">
<link href="./04_AutocorrelacionEspacial.html" rel="prev">
<link href="./images/udl.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./03_DatosEspaciales.html">UNIDAD 2: GEOESTADÍSTICA Y ANÁLISIS ESPACIAL</a></li><li class="breadcrumb-item"><a href="./05_PatronPuntos.html"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Análisis de patrón de puntos en R</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Apuntes y ejercicios de geoestadística para forestales</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/ameztegui/labs_geoestadistica_forestal" rel="" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Presentación</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">UNIDAD 0: INTRODUCCION</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00_Familiar_RStudio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Familiarizándose con R y RStudio</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00_Intro_R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introducción a R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00_RMarkdown_Quarto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Introducción a Quarto y RMarkdown</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">UNIDAD 1: ANÁLISIS DE REGRESIÓN</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_RegresionLineal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Regresión lineal en R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_GLM.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Regresión lineal generalizada (GLM) en R</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">UNIDAD 2: GEOESTADÍSTICA Y ANÁLISIS ESPACIAL</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_DatosEspaciales.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Trabajando con datos espaciales en R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_AutocorrelacionEspacial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Autocorrelación espacial</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_PatronPuntos.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Análisis de patrón de puntos en R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06_InterpolacionEspacial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Interpolación espacial</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07_RegresionEspacial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Regresión espacial</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introducción" id="toc-introducción" class="nav-link active" data-scroll-target="#introducción"><span class="header-section-number">8.1</span> Introducción</a></li>
  <li><a href="#familiarizándose-con-los-objetos-ppp" id="toc-familiarizándose-con-los-objetos-ppp" class="nav-link" data-scroll-target="#familiarizándose-con-los-objetos-ppp"><span class="header-section-number">8.2</span> Familiarizándose con los objetos `ppp`</a></li>
  <li><a href="#estadísticas-descriptivas-centrografía" id="toc-estadísticas-descriptivas-centrografía" class="nav-link" data-scroll-target="#estadísticas-descriptivas-centrografía"><span class="header-section-number">8.3</span> Estadísticas descriptivas (centrografía)</a></li>
  <li><a href="#análisis-basados-en-densidad" id="toc-análisis-basados-en-densidad" class="nav-link" data-scroll-target="#análisis-basados-en-densidad"><span class="header-section-number">8.4</span> Análisis basados en densidad</a>
  <ul class="collapse">
  <li><a href="#intensidad-global" id="toc-intensidad-global" class="nav-link" data-scroll-target="#intensidad-global"><span class="header-section-number">8.4.1</span> Intensidad global</a></li>
  <li><a href="#análisis-de-cuadrículas" id="toc-análisis-de-cuadrículas" class="nav-link" data-scroll-target="#análisis-de-cuadrículas"><span class="header-section-number">8.4.2</span> Análisis de cuadrículas</a></li>
  <li><a href="#análisis-de-cuadrículas-basadas-en-covariable" id="toc-análisis-de-cuadrículas-basadas-en-covariable" class="nav-link" data-scroll-target="#análisis-de-cuadrículas-basadas-en-covariable"><span class="header-section-number">8.4.3</span> Análisis de cuadrículas basadas en covariable</a></li>
  <li><a href="#densidad-en-kernel" id="toc-densidad-en-kernel" class="nav-link" data-scroll-target="#densidad-en-kernel"><span class="header-section-number">8.4.4</span> Densidad en kernel</a></li>
  </ul></li>
  <li><a href="#análisis-basados-en-la-distancia" id="toc-análisis-basados-en-la-distancia" class="nav-link" data-scroll-target="#análisis-basados-en-la-distancia"><span class="header-section-number">8.5</span> Análisis basados en la distancia</a>
  <ul class="collapse">
  <li><a href="#vecinos-más-próximos-ann" id="toc-vecinos-más-próximos-ann" class="nav-link" data-scroll-target="#vecinos-más-próximos-ann"><span class="header-section-number">8.5.1</span> Vecinos más próximos (ANN)</a></li>
  <li><a href="#función-g-y-función-f" id="toc-función-g-y-función-f" class="nav-link" data-scroll-target="#función-g-y-función-f"><span class="header-section-number">8.5.2</span> Función <span class="math inline">\(G\)</span> y función <span class="math inline">\(F\)</span></a></li>
  <li><a href="#función-k-y-función-l" id="toc-función-k-y-función-l" class="nav-link" data-scroll-target="#función-k-y-función-l"><span class="header-section-number">8.5.3</span> Función <span class="math inline">\(K\)</span> y función <span class="math inline">\(L\)</span></a></li>
  <li><a href="#función-de-correlación-de-pares" id="toc-función-de-correlación-de-pares" class="nav-link" data-scroll-target="#función-de-correlación-de-pares"><span class="header-section-number">8.5.4</span> Función de correlación de pares</a></li>
  </ul></li>
  <li><a href="#análisis-de-patrones-de-puntos-marcados" id="toc-análisis-de-patrones-de-puntos-marcados" class="nav-link" data-scroll-target="#análisis-de-patrones-de-puntos-marcados"><span class="header-section-number">8.6</span> Análisis de patrones de puntos “marcados”</a>
  <ul class="collapse">
  <li><a href="#marcas-numéricas" id="toc-marcas-numéricas" class="nav-link" data-scroll-target="#marcas-numéricas"><span class="header-section-number">8.6.1</span> Marcas numéricas</a></li>
  <li><a href="#marcas-categóricas" id="toc-marcas-categóricas" class="nav-link" data-scroll-target="#marcas-categóricas"><span class="header-section-number">8.6.2</span> Marcas categóricas</a></li>
  <li><a href="#crear-objetos-ppp-con-marcas" id="toc-crear-objetos-ppp-con-marcas" class="nav-link" data-scroll-target="#crear-objetos-ppp-con-marcas"><span class="header-section-number">8.6.3</span> Crear objetos ppp con marcas</a></li>
  <li><a href="#análisis-exploratoriodescriptivo" id="toc-análisis-exploratoriodescriptivo" class="nav-link" data-scroll-target="#análisis-exploratoriodescriptivo"><span class="header-section-number">8.6.4</span> Análisis exploratorio/descriptivo</a></li>
  <li><a href="#efectos-de-primer-orden-dependientes-de-la-densidad" id="toc-efectos-de-primer-orden-dependientes-de-la-densidad" class="nav-link" data-scroll-target="#efectos-de-primer-orden-dependientes-de-la-densidad"><span class="header-section-number">8.6.5</span> Efectos de primer orden (dependientes de la densidad)</a></li>
  <li><a href="#efectos-de-segundo-orden-dependientes-de-la-distancia" id="toc-efectos-de-segundo-orden-dependientes-de-la-distancia" class="nav-link" data-scroll-target="#efectos-de-segundo-orden-dependientes-de-la-distancia"><span class="header-section-number">8.6.6</span> Efectos de segundo orden (dependientes de la distancia)</a></li>
  </ul></li>
  <li><a href="#conclusiones" id="toc-conclusiones" class="nav-link" data-scroll-target="#conclusiones"><span class="header-section-number">8.7</span> Conclusiones</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/ameztegui/labs_geoestadistica_forestal/edit/main/05_PatronPuntos.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/ameztegui/labs_geoestadistica_forestal/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-PointPattern" class="quarto-section-identifier"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Análisis de patrón de puntos en R</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="introducción" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="introducción"><span class="header-section-number">8.1</span> Introducción</h2>
<p>Como vimos en clase, un conjunto de datos de patrones de puntos contiene una serie de eventos (es decir, objetos de interés) que ocurren en una región de estudio definida. Estos eventos pueden representar cualquier cosa con una ubicación medible, incluyendo árboles, nidos de animales, ubicaciones de estaciones meteorológicas, ocurrencias de delitos, etc. sin que exista necesariamente una variable de interés. Es decir, lo que nos interesa es la ubicación de los eventos más que su valor.</p>
<p>Como hemos visto, los patrones de puntos tienen propiedades de <strong>primer orden</strong>, que están relacionadas con la <em>intensidad</em> (es decir, la densidad) de los sucesos en la región de estudio, y propiedades de <strong>segundo orden</strong>, que están relacionadas con la <em>dependencia espacial</em> (es decir, la disposición espacial) de los sucesos en la zona de estudio.</p>
<p><strong>Objetivo</strong></p>
<p>El objetivo del lab de hoy es aprender algunos enfoques estadísticos espaciales para caracterizar las propiedades de primer y segundo orden de un patrón de puntos.</p>
<p><strong>Datos y librerías</strong></p>
<p>Para realizar un análisis de patrón de puntos utilizaremos fundamentalmente el paquete de R <code>spatstat</code>. Lo primero que debemos hacer es instalarlo - a no ser que ya lo tengamos instalado - y cargarlo:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("spatstat") (sólo si no está ya instalado)</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(spatstat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Además, vamos a utilizar tres de los datasets que vienen cargados por defecto por la librería <code>spatstat</code>. El primero, llamado <code>bei</code>, contiene la localización de 3605 árboles en una parcela de bosque tropical. Además, viene acompañado del fichero <code>bei.extra</code>, que contiene información continua acerca de la altitud y la pendiente en la parcela de estudio. El segundo dataset que usaremos se llama <code>longleaf</code>, y es un fichero de patrón de puntos “marcado”, es decir que contiene la localización de una serie de pinos de Virginia (longleaf pine), una especie común en el sudeste de EEUU, pero también contiene su diámetro, por eso decimos que es un fichero “marcado”. Finalmente, el fichero llamado <code>lansing</code> contiene la ubicación de una serie de 5 especies de árboles en una parcela de Lansing, en el estado de Michigan.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="05_PatronPuntos_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="05_PatronPuntos_files/figure-html/unnamed-chunk-2-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="05_PatronPuntos_files/figure-html/unnamed-chunk-2-3.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>NOTA:</strong> al plotear los ficheros precargados del paquete <code>spatstat</code> podemos definir algunos parámetros de los puntos, como hacemos con un scatterplot normal. En este caso hemos modificado el tipo de puntos, su tamaño y el color, mediante los comandos <code>pch</code> ,<code>cex</code>, y <code>cols</code>, respectivamente. Podéis encontrar más información de como modificar los parámetros de un gráfico <a href="https://www.statmethods.net/advgraphs/parameters.html">aquí</a></p>
</section>
<section id="familiarizándose-con-los-objetos-ppp" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="familiarizándose-con-los-objetos-ppp"><span class="header-section-number">8.2</span> Familiarizándose con los objetos `ppp`</h2>
<p>El paquete <code>spatstat</code> usa una clase específica de objetos de R llamados ppp (planar point pattern). Los datos que vamos a usar, que se cargan automáticamente al instalar <code>spatstat</code> son objetos de esa clase.</p>
<p>Examinemos el dataset <code>bei</code>. Para ello devemos abrirlo tecleando:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(bei)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Y podemos ver su contenido tecleando su nombre:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>bei</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Planar point pattern: 3604 points
window: rectangle = [0, 1000] x [0, 500] metres</code></pre>
</div>
</div>
<p>Vemos que es un archivo de patrón de puntos con 3604 observaciones. El objeto <code>ppp</code> también contiene información sobre la región que contiene los eventos. En este caso, es un rectángulo con un rango de coordenadas <span class="math inline">\(x\)</span> de entre 0 y 1000 , y un rango de <span class="math inline">\(y\)</span> de entre 0 y 500, y las unidades en metros.</p>
<p>Podemos visualizar el objeto <code>bei</code> escribiendo:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(bei)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_PatronPuntos_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Igual que hemos hecho hasta ahora, podemos cambiar el color, formato de los puntos, y otras características del plot</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(bei, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">cols =</span> <span class="st">"dark blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_PatronPuntos_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<!-- Tratemos ahora de responder a las siguientes preguntas -->
<!-- -   ¿Qué tipo de objeto es `lansing`? ¿Y `bei`? -->
<!-- -   ¿Cuántos objetos tiene cada uno de ellos? -->
<!-- -   ¿De qué tamaño es la "ventana" de `lansing`? ¿Y la de bei? -->
<!-- -   Realiza un plot donde se vea el objeto `bei`, y cambia el color de los puntos -->
</section>
<section id="estadísticas-descriptivas-centrografía" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="estadísticas-descriptivas-centrografía"><span class="header-section-number">8.3</span> Estadísticas descriptivas (centrografía)</h2>
<p>Los estadísticos centrográficos son estadísticos descriptivos simples que se utilizan a menudo para el análisis exploratorio de datos en la estadística espacial. Los estadísticos centrográficos, como la posición central, la desviación estándar, la elipse de desviación estándar pueden utilizarse para ayudar a la caracterización de la distribución espacial de los conjuntos de datos referenciados espacialmente.</p>
<p>En <span class="math inline">\(R\)</span> podemos calcular por ejemplo la posición media y mediana de los puntos, lo haremos con el dataset <code>bei</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>x_media <span class="ot">&lt;-</span> <span class="fu">mean</span>(bei<span class="sc">$</span>x)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>y_media <span class="ot">&lt;-</span> <span class="fu">mean</span>(bei<span class="sc">$</span>y)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>x_mediana <span class="ot">&lt;-</span> <span class="fu">median</span>(bei<span class="sc">$</span>x)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>y_mediana <span class="ot">&lt;-</span> <span class="fu">median</span>(bei<span class="sc">$</span>y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>y representarlo gráficamente sobre los puntos:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(bei, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">cex =</span> <span class="fl">0.5</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(x_media, y_media, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">pch =</span> <span class="dv">3</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(x_mediana, y_mediana, <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">pch =</span> <span class="dv">4</span>, <span class="at">lwd=</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_PatronPuntos_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>También podemos calcular la desviación estándard y usarla para construir un círculo con ese radio:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>x_sd <span class="ot">&lt;-</span> <span class="fu">sd</span>(bei<span class="sc">$</span>x)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>y_sd <span class="ot">&lt;-</span> <span class="fu">sd</span>(bei<span class="sc">$</span>y)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>sd_bei <span class="ot">=</span> <span class="fu">mean</span>(x_sd, y_sd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Y plotearlo, pero para dibujar un círculo necesitamos la función <code>draw.circle()</code> del paquete <code>plotrix</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotrix)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(bei, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">cex =</span> <span class="fl">0.5</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(x_media, y_media, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">pch =</span> <span class="dv">3</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="fu">draw.circle</span>(<span class="at">x=</span> x_media, <span class="at">y =</span> y_media, <span class="at">border =</span> <span class="st">"red"</span>, </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">radius =</span> sd_bei, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_PatronPuntos_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>En ArcGis Pro y QGis también existen funciones para realizar este tipo de análisis y visualización. En concreto, podemos usar las funciones <code>mean center</code>, o <code>standard distance</code> dentro del toolbox <code>Spatial Statistics</code>. Incluso podemos dibujar la elipse de desviación estandard mediante la función <code>directional distribution</code>.</p>
</section>
<section id="análisis-basados-en-densidad" class="level2" data-number="8.4">
<h2 data-number="8.4" class="anchored" data-anchor-id="análisis-basados-en-densidad"><span class="header-section-number">8.4</span> Análisis basados en densidad</h2>
<section id="intensidad-global" class="level3" data-number="8.4.1">
<h3 data-number="8.4.1" class="anchored" data-anchor-id="intensidad-global"><span class="header-section-number">8.4.1</span> Intensidad global</h3>
<p>Como hemos visto en la teoría, la intensidad de un proceso expresado en patrón de puntos puede calcularse a través de la siguiente ecuación:</p>
<p><span class="math inline">\(\lambda = {n}/{a}\)</span></p>
<p>donde <span class="math inline">\(\lambda\)</span> es la intensidad, <span class="math inline">\(n\)</span> es el número de observaciones y <span class="math inline">\(a\)</span> la superficie considerada como área de estudio. Conociendo estos dos parámetros podemos calcular la intensidad:</p>
<p>El número de observaciones es un parámetro del objeto <code>ppp</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>n_obs <span class="ot">&lt;-</span> bei<span class="sc">$</span>n</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>y el área lo podemos obtener también de un objeto <code>ppp</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>bei<span class="sc">$</span>window</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>window: rectangle = [0, 1000] x [0, 500] metres</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>superf <span class="ot">&lt;-</span> <span class="fu">area</span>(bei<span class="sc">$</span>window)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>superf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5e+05</code></pre>
</div>
</div>
<p>Por tanto la intensidad será:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>intens_bei <span class="ot">&lt;-</span> n_obs <span class="sc">/</span> superf</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>intens_bei</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.007208</code></pre>
</div>
</div>
<p>Sin embargo, <code>spatstat</code> ya proporciona una función <code>summary()</code> que nos proporciona información de la muestra, entre ella la intensidad:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bei)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Planar point pattern:  3604 points
Average intensity 0.007208 points per square metre

Coordinates are given to 1 decimal place
i.e. rounded to the nearest multiple of 0.1 metres

Window: rectangle = [0, 1000] x [0, 500] metres
Window area = 5e+05 square metres
Unit of length: 1 metre</code></pre>
</div>
</div>
<p>También podemos acceder a la intensidad de forma directa:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bei)<span class="sc">$</span>intensity</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.007208</code></pre>
</div>
</div>
<!-- Calcula la intensidad global de eventos en el objeto `longleaf` y en `lansing`. Recuerda tener en cuenta las unidades de área. -->
</section>
<section id="análisis-de-cuadrículas" class="level3" data-number="8.4.2">
<h3 data-number="8.4.2" class="anchored" data-anchor-id="análisis-de-cuadrículas"><span class="header-section-number">8.4.2</span> Análisis de cuadrículas</h3>
<p>Calcular la intensidad global de un proceso de puntos puede tener interés para comparar dos muestras diferentes, o cambios temporales, pero para caracterizar de forma más completa la muestra debemos determinar cómo varía la intensidad en el espacio. Una forma sencilla es a través del conteo por cuadrículas. Consiste en dividir el área de estudio en una serie de cuadrículas de tamaño constante, y calcular la intensidad en cada una de ellas. El resultado nos puede ayudar a determinar si el patrón de eventos está distribuido regularmente o de manera agrupada. <code>spatstat</code> contiene una función (<code>quadratcount()</code>) que nos permite calcularlo de manera muy sencilla.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>q <span class="ot">&lt;-</span> <span class="fu">quadratcount</span>(bei, <span class="at">nx=</span> <span class="dv">4</span>, <span class="at">ny =</span> <span class="dv">4</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>q</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           x
y           [0,250) [250,500) [500,750) [750,1e+03]
  [375,500]     368       506        64         287
  [250,375)     298       171        66         194
  [125,250)     324        27        54         178
  [0,125)       220       138       589         120</code></pre>
</div>
</div>
<p>También podemos visualizarlo:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(bei, <span class="at">cols =</span> <span class="st">"gray"</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">cex =</span> <span class="fl">0.5</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(q, <span class="at">add =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_PatronPuntos_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>En las sesiones teóricas vimos que la hipótesis nula en el caso de una distrbución de puntos es que estos se encuentran repartidos aleatoriamente en las cuadrículas. Sabiendo la intensidad de la muestra, podemos generar una serie de puntos aleatorios, que sigan una distribución de Poisson. Este numero de eventos, que sería el esperado en una muestra que cumpla la aleatoriedad, se compara con lo que realmente tenemos (observado) mediante un test de Chi-cuadrado, que en <code>spatstat</code> viene implementado en la función <code>quadrat.test()</code>, que se puede usar con el objeto <code>ppp</code> o con el resultado de <code>quadratcount()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quadrat.test</span>(bei, <span class="at">nx=</span> <span class="dv">4</span>, <span class="at">ny =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Chi-squared test of CSR using quadrat counts

data:  bei
X2 = 1754.6, df = 15, p-value &lt; 2.2e-16
alternative hypothesis: two.sided

Quadrats: 4 by 4 grid of tiles</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quadrat.test</span>(q)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Chi-squared test of CSR using quadrat counts

data:  
X2 = 1754.6, df = 15, p-value &lt; 2.2e-16
alternative hypothesis: two.sided

Quadrats: 4 by 4 grid of tiles</code></pre>
</div>
</div>
<p>En este caso, vemos que el p-valor es claramente inferior a 0.05, por lo que podemos rechazar la hipótesis nula, y por tanto decidir que los puntos no se distribuyen aleatoriamente. También podemos ver este resultado de manera gráfica:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">quadrat.test</span>(bei, <span class="at">nx =</span> <span class="dv">4</span>, <span class="at">ny =</span> <span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_PatronPuntos_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Podemos por supuesto cambiar el número de cuadrículas a nuestro antojo:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>Q9 <span class="ot">&lt;-</span> <span class="fu">quadratcount</span>(bei, <span class="at">nx =</span> <span class="dv">3</span>, <span class="at">ny =</span> <span class="dv">3</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(bei, <span class="at">cex =</span> <span class="fl">0.5</span>, <span class="at">pch =</span> <span class="st">"+"</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Q9, <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">cex =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_PatronPuntos_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quadrat.test</span>(Q9)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Chi-squared test of CSR using quadrat counts

data:  
X2 = 1166.1, df = 8, p-value &lt; 2.2e-16
alternative hypothesis: two.sided

Quadrats: 3 by 3 grid of tiles</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>Q24 <span class="ot">&lt;-</span> <span class="fu">quadratcount</span>(bei, <span class="at">nx =</span> <span class="dv">6</span>, <span class="at">ny =</span> <span class="dv">4</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(bei,  <span class="at">cex =</span> <span class="fl">0.5</span>, <span class="at">pch =</span> <span class="st">"+"</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Q24, <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">cex =</span> <span class="fl">1.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_PatronPuntos_files/figure-html/unnamed-chunk-22-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quadrat.test</span>(Q24)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Chi-squared test of CSR using quadrat counts

data:  
X2 = 2222, df = 23, p-value &lt; 2.2e-16
alternative hypothesis: two.sided

Quadrats: 6 by 4 grid of tiles</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>Q120 <span class="ot">&lt;-</span> <span class="fu">quadratcount</span>(bei, <span class="at">nx =</span> <span class="dv">10</span>, <span class="at">ny =</span> <span class="dv">12</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(bei, <span class="at">use.marks =</span> F, <span class="at">cex =</span> <span class="fl">0.5</span>, <span class="at">pch =</span> <span class="st">"+"</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Q120, <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_PatronPuntos_files/figure-html/unnamed-chunk-22-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quadrat.test</span>(Q120)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Chi-squared test of CSR using quadrat counts

data:  
X2 = 3558.8, df = 119, p-value &lt; 2.2e-16
alternative hypothesis: two.sided

Quadrats: 10 by 12 grid of tiles</code></pre>
</div>
</div>
<p>También podemos calcular la <strong>densidad</strong> de puntos en cada cuadrado, en vez del número total:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>q_dens <span class="ot">&lt;-</span> <span class="fu">intensity</span>(Q9)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>q_dens</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           x
y            [0,333) [333,667) [667,1e+03]
  [333,500] 0.017010  0.004230    0.006714
  [167,333) 0.008478  0.001242    0.004932
  [0,167)   0.006570  0.008964    0.006732</code></pre>
</div>
</div>
<p>Y plotearlo:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">intensity</span>(Q9, <span class="at">image=</span><span class="cn">TRUE</span>))  </span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(bei, <span class="at">use.marks =</span> F, <span class="at">pch=</span><span class="dv">20</span>, <span class="at">add=</span><span class="cn">TRUE</span>)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_PatronPuntos_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<!-- Prueba ahora a plotear la intensidad de otro del dataset `lansing`, usando 16 cuadrículas.  ¿Qué cuadriculas tienen mayor o menor intensidad? Basándote en este análisis, podemos rechazar o no la hipótesis de aleatoriedad en la distribución de la muestra? ¿Por qué o por qué no?  -->
</section>
<section id="análisis-de-cuadrículas-basadas-en-covariable" class="level3" data-number="8.4.3">
<h3 data-number="8.4.3" class="anchored" data-anchor-id="análisis-de-cuadrículas-basadas-en-covariable"><span class="header-section-number">8.4.3</span> Análisis de cuadrículas basadas en covariable</h3>
<p>A menudo, más que dividir el terreno en un número de cuadrículas regulares, nos interesa dividirlo según alguna variable continua de interés, que pensemos que puede explicar la distribución. Ya comentamos que <code>spatstat</code> proporciona, junto con el dataset <code>bei</code>, otro llamado <code>bei.extra</code> que contiene los valores de altitud y pendiente en la misma parcela. Echémosles un vistazo:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>bei.extra</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of pixel images

elev:
real-valued pixel image
101 x 201 pixel array (ny, nx)
enclosing rectangle: [-2.5, 1002.5] x [-2.5, 502.5] metres

grad:
real-valued pixel image
101 x 201 pixel array (ny, nx)
enclosing rectangle: [-2.5, 1002.5] x [-2.5, 502.5] metres</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(bei.extra<span class="sc">$</span>elev)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_PatronPuntos_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(bei.extra<span class="sc">$</span>grad)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_PatronPuntos_files/figure-html/unnamed-chunk-26-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Veamos como se distribuyen los puntos en clases de pendiente. Para ello debemos reclasificar el raster de elevaciones en 5 clases: &lt;130, 130 a 140, de 140 a 150, de 150 a 160, y &gt;160. Para ello usaremos la función <code>cut()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(bei.extra<span class="sc">$</span>elev)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_PatronPuntos_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>clases_elev <span class="ot">&lt;-</span> <span class="fu">cut</span>(bei.extra<span class="sc">$</span>elev, <span class="at">breaks =</span> <span class="fu">c</span>( <span class="sc">-</span><span class="cn">Inf</span>, <span class="dv">130</span>, <span class="dv">140</span>, <span class="dv">150</span>, <span class="dv">160</span> , <span class="cn">Inf</span>), </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">labels=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)  <span class="co"># Classify the raster</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(clases_elev)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Interpreting pixel values as colours (valuesAreColours=TRUE)</code></pre>
</div>
<div class="cell-output-display">
<p><img src="05_PatronPuntos_files/figure-html/unnamed-chunk-27-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<!-- Ahora creamos una superficie teselada - un tipo especial de objeto espacial - usando `tess()`: -->
<!-- ```{r} -->
<!-- E <- tess(image=clases_elev)  # Create a tesselated surface -->
<!-- plot(E) -->
<!-- ``` -->
<p>Ahora usamos de nuevo la función <code>quadratcount</code>. pero indicando que queremos “teselar” por las clases de elevación:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>Q_tes   <span class="ot">&lt;-</span> <span class="fu">quadratcount</span>(bei, <span class="at">tess =</span> clases_elev)  </span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>I_tes <span class="ot">&lt;-</span> <span class="fu">intensity</span>(Q_tes)  <span class="co"># Compute density</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>I_tes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tile
          1           2           3           4 
0.002415371 0.006514200 0.008701685 0.005409613 </code></pre>
</div>
</div>
<p>Estos números son el número de puntos por metro cuadrado en cada clase de elevación. Podemos visualizarlo como antes:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">intensity</span>(Q_tes, <span class="at">image=</span><span class="cn">TRUE</span>))</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(bei, <span class="at">pch=</span><span class="dv">20</span>, <span class="at">add=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_PatronPuntos_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Y también podemos realizar un test estadístico de este conteo:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quadrat.test</span>(Q_tes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Chi-squared test of CSR using quadrat counts

data:  
X2 = 232.08, df = 3, p-value &lt; 2.2e-16
alternative hypothesis: two.sided

Quadrats: 4 tiles (levels of a pixel image)</code></pre>
</div>
</div>
<!-- ¿Qué podemos decir del test en este caso? Se distribuyen los puntos de manera homogénea por las cuadrículas de elevación. Si tienes tiempo, evalúa si pasa lo mismo con la pendiente. -->
</section>
<section id="densidad-en-kernel" class="level3" data-number="8.4.4">
<h3 data-number="8.4.4" class="anchored" data-anchor-id="densidad-en-kernel"><span class="header-section-number">8.4.4</span> Densidad en kernel</h3>
<p>El recuento de cuadrículas es útil para caracterizar la intensidad de un proceso puntual no homogéneo, pero tiene sus limitaciones:</p>
<ul>
<li>La elección del origen, la orientación de las cuadrículas y el tamaño de los mismos afecta a la distribución de frecuencias observada, y no deja de ser una decisión arbitraria.</li>
<li>Se pierde una cantidad significativa de información de detalle</li>
</ul>
<p>Para evitar el problema podemos hacer un análisis mediante algoritmos KDE (kernel density estimation), que utilizan un enfoque de ventana móvil para caracterizar la intensidad. Este enfoque tiende a preservar una mayor cantidad de detalles espaciales y no sufre tanto por la elección del origen, la orientación y el tamaño de las cuadrículas.</p>
<p>El paquete <code>spatstat</code> tiene una función (<code>density</code>) que calcula un kernel a partir del patrón de puntos, y determina la densidad de puntos de cada celda del área de estudio según ese kernel.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>K1 <span class="ot">&lt;-</span> <span class="fu">density</span>(bei) </span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(K1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_PatronPuntos_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Para mejorar la visualización podemos añadirles las isolíneas de densidad, y los puntos, para comprobar el resultado:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(K1)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">contour</span>(K1, <span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(bei, <span class="at">pch=</span><span class="dv">20</span>, <span class="at">add=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_PatronPuntos_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>El ancho de banda (es decir, el radio) de la función kernel se define automáticamente en función del área de estudio, pero se puede personalizar también, usando el parámetro <code>sigma</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>K2 <span class="ot">&lt;-</span> <span class="fu">density</span>(bei, <span class="at">sigma=</span><span class="dv">200</span>) </span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(K2, <span class="at">main=</span><span class="cn">NULL</span>)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="fu">contour</span>(K2, <span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(bei, <span class="at">pch=</span><span class="dv">20</span>, <span class="at">add=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_PatronPuntos_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<!-- Prueba a modificar el ancho de banda a los siguientes valores: 10, 20, 50, 100, 200, 500. ¿Cómo influye incrementar y reducir el ancho de banda en las estimaciones de densidad? ¿Cuál produce mejores estimaciones de densidad? ¿Por qué? -->
<p>Antes hemos visto cómo crear cuadrículas en función de los valores de una covariable. Podemos aprovechar las funcionalidades de los cálculos de intensidad con kernel para determinar de manera directa si la intensidad de un proceso de patrón de puntos depende de alguna covariable. Podemos usar la función <code>rhohat()</code>, indicando qué dataset queremos analizar, y con qué variable se quiere evaluar:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rhohat</span>(bei, bei.extra<span class="sc">$</span>grad)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Intensity function estimate (class rhohat) for the covariate X
Function values are absolute intensities
Type of estimate: Smooth function of covariate
Estimation method: ratio of fixed-bandwidth kernel smoothers
    Actual smoothing bandwidth sigma =  0.010347
Pointwise 95% confidence bands for rho(x)
     based on asymptotic variance of rhohat(x)
Call: rhohat.ppp(bei, bei.extra$grad)

Function value object (class 'fv')
for the function X -&gt; rho(X)
...........................................................................
    Math.label            Description                                      
X   X                     Covariate X                                      
rho hat(rho)(X)           Estimated intensity                              
ave bar(rho)              Average intensity                                
var bold(Var)~hat(rho)(X) Variance of estimator                            
hi  rho[hi](X)            Upper limit of pointwise 95%% confidence interval
lo  rho[lo](X)            Lower limit of pointwise 95%% confidence interval
...........................................................................
Default plot formula:  .~X
where "." stands for 'rho', 'ave', 'hi', 'lo'
Columns 'hi' and 'lo' will be plotted as shading (by default)
Recommended range of argument X: [0.00087115, 0.32846]
Available range of argument X: [0.00087115, 0.32846]</code></pre>
</div>
</div>
<p>La salida de la función <code>rhohat()</code> no es muy clara, pero podemos plotearla:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">rhohat</span>(bei, bei.extra<span class="sc">$</span>grad))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_PatronPuntos_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>El plot es una estimación de la intensidad en función de la pendiente del terreno. Indica que es más infrecuente encontrar árboles en terrenos llanos (pendiente &lt; 0.05) que en zonas de pendientes más altas. La linea negra <span class="math inline">\(\rho\)</span> es la intensidad estimada, mientras que la región en gris representa el intervalo de confianza.</p>
</section>
</section>
<section id="análisis-basados-en-la-distancia" class="level2" data-number="8.5">
<h2 data-number="8.5" class="anchored" data-anchor-id="análisis-basados-en-la-distancia"><span class="header-section-number">8.5</span> Análisis basados en la distancia</h2>
<p>Los análisis basados en la distancia están relacionados con las propiedades de segundo orden de los puntos, es decir, con la dependencia espacial entre ellos. Existen varios métodos, que evaluaremos de nuevo sobre el fichero <code>bei</code>:</p>
<section id="vecinos-más-próximos-ann" class="level3" data-number="8.5.1">
<h3 data-number="8.5.1" class="anchored" data-anchor-id="vecinos-más-próximos-ann"><span class="header-section-number">8.5.1</span> Vecinos más próximos (ANN)</h3>
<p>Podemos calcular la distancia entre cada árbol y su vecino más próximo, usando <code>nndist()</code> y fijando <code>k = 1</code> (para extraer la distancia al más próximo), y calculamos la media de todas las distancias:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>dist1 <span class="ot">&lt;-</span> <span class="fu">nndist</span>(bei, <span class="at">k=</span><span class="dv">1</span>)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dist1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2236068 0.9848858 3.3241540 8.0777472 5.8137767 5.9203040</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(dist1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.329677</code></pre>
</div>
</div>
<p>También podemos calcularlo con el segundo vecino de cada árbol, o con el tercero, o el n-ésimo…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">nndist</span>(bei, <span class="at">k=</span><span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.473149</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">nndist</span>(bei, <span class="at">k=</span><span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8.120378</code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">nndist</span>(bei, <span class="at">k=</span><span class="dv">15</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 19.64182</code></pre>
</div>
</div>
<p>Con una función podemos calcular NN para cualquier valor de vecino deseado, y luego calcular la media:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>ANN <span class="ot">&lt;-</span> <span class="fu">apply</span>(<span class="fu">nndist</span>(bei, <span class="at">k=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">200</span>),<span class="dv">2</span>,<span class="at">FUN=</span>mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Después ploteamos la distancia media al vecino k-ésimo, que nos da información sobre cómo se distribuyen los puntos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">200</span>), ANN)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_PatronPuntos_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="función-g-y-función-f" class="level3" data-number="8.5.2">
<h3 data-number="8.5.2" class="anchored" data-anchor-id="función-g-y-función-f"><span class="header-section-number">8.5.2</span> Función <span class="math inline">\(G\)</span> y función <span class="math inline">\(F\)</span></h3>
<p>Podemos realizar un test más formal de cómo varía la distancia al vecino más próximo, usando la función <code>G(r)</code>, que calcula la distribución acumulada de la distancia de un punto cualquiera <code>x</code> a su punto más próximo. El valor de <span class="math inline">\(G(r)\)</span> es la proporción de puntos que tienen su vecino más cercano a una distancia igual o inferior a <span class="math inline">\(r\)</span>. Esta función viene implementada en <code>spatstat</code> como <code>Gest()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>G_bei <span class="ot">&lt;-</span> <span class="fu">Gest</span>(bei)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(G_bei)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_PatronPuntos_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>El comando de arriba produce un gráfico que compara la función <em>G</em> observada o empírica y la esperada si la distribución fuera aleatoria (linea azul). En este caso, los valores empíricos son muy superiores, lo que indica agrupación en los puntos.</p>
<p>Para poder saber si las diferencias entre la función empírica y la teórica son significativas (es decir, si realmente podemos rechazar que los puntos se distribuyan al azar), podemos usar la función <code>envelope()</code>. Esta función genera un número de muestras con la misma cantidad de puntos pero distribución aleatoria, y compara nuestra muestra a ellas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>g_bei_env <span class="ot">&lt;-</span> <span class="fu">envelope</span>(bei, Gest, <span class="at">nsim =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generating 100 simulations of CSR  ...
1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,
41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60,
61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,
81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 
100.

Done.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(g_bei_env)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_PatronPuntos_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Vemos que ahora se ha representado una banda gris alrededor de la función G teórica, que indica el intervalo de confianza generado a partir de las 100 simulaciones que hemos realizado (<code>nsim = 100</code>)</p>
<p>De manera análoga, la función <code>F</code> representa la frecuencia acumulada de la distancia más corta entre un punto y un conjunto de puntos aleatoriamente localizados en el área de estudio:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>f_bei_env <span class="ot">&lt;-</span> <span class="fu">envelope</span>(bei, Fest, <span class="at">nsim =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generating 100 simulations of CSR  ...
1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,
41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60,
61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,
81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 
100.

Done.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(f_bei_env)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_PatronPuntos_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>En este caso, valores más altos que los teóricos indican patrones regulares (mayor distancia entre puntos), mientras que los más bajos indican agrupación. Como la linea observada va muy por debajo de la teórica, podemos concluir que nuestros puntos están agrupados.</p>
</section>
<section id="función-k-y-función-l" class="level3" data-number="8.5.3">
<h3 data-number="8.5.3" class="anchored" data-anchor-id="función-k-y-función-l"><span class="header-section-number">8.5.3</span> Función <span class="math inline">\(K\)</span> y función <span class="math inline">\(L\)</span></h3>
<p>La función <span class="math inline">\(K\)</span> calcula, para una serie de bandas concéntricas a cada punto de la muestra, el número de puntos que cae dentro de la banda. Esto nos da un valor de <span class="math inline">\(K\)</span> para cada distancia, valor que siempre debe aumentar con la distancia. Para calcular la función <span class="math inline">\(K\)</span> podemos usar la función de R <code>Kest()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="fu">Kest</span>(bei)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>number of data points exceeds 3000 - computing border correction estimate only</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(K)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_PatronPuntos_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>En este caso, la curva por encima de la teórica (Poisson) indica agrupación de puntos. Podemos calcular el intervalo de confianza igual que hemos hecho antes:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>k_bei_env <span class="ot">&lt;-</span> <span class="fu">envelope</span>(bei, Kest, <span class="at">nsim =</span> <span class="dv">30</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generating 30 simulations of CSR  ...
1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
21, 22, 23, 24, 25, 26, 27, 28, 29, 
30.

Done.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(k_bei_env)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_PatronPuntos_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>La función <span class="math inline">\(L\)</span>, que es sólo una modificación de <span class="math inline">\(K\)</span>, se calcula fácilmente, casi de la misma manera:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>L <span class="ot">&lt;-</span> <span class="fu">Lest</span>(bei)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>number of data points exceeds 3000 - computing border correction estimate only</code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(L, . <span class="sc">-</span>r <span class="sc">~</span> r)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_PatronPuntos_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>L_bei_env <span class="ot">&lt;-</span> <span class="fu">envelope</span>(bei, Lest, <span class="at">nsim =</span> <span class="dv">99</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generating 99 simulations of CSR  ...
1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,
41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60,
61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,
81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 
99.

Done.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(L_bei_env, . <span class="sc">-</span>r <span class="sc">~</span> r)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_PatronPuntos_files/figure-html/unnamed-chunk-45-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="función-de-correlación-de-pares" class="level3" data-number="8.5.4">
<h3 data-number="8.5.4" class="anchored" data-anchor-id="función-de-correlación-de-pares"><span class="header-section-number">8.5.4</span> Función de correlación de pares</h3>
<p>La función de correlación de pares no es más que una version modificada de K en la que se hacen bandas anulares concéntricas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>pcf_bei  <span class="ot">&lt;-</span> <span class="fu">pcf</span>(bei)</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pcf_bei)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_PatronPuntos_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>pcf_bei_env <span class="ot">&lt;-</span> <span class="fu">envelope</span>(bei, pcf, <span class="at">nsim =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generating 10 simulations of CSR  ...
1, 2, 3, 4, 5, 6, 7, 8, 9, 
10.

Done.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pcf_bei_env)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_PatronPuntos_files/figure-html/unnamed-chunk-46-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="análisis-de-patrones-de-puntos-marcados" class="level2" data-number="8.6">
<h2 data-number="8.6" class="anchored" data-anchor-id="análisis-de-patrones-de-puntos-marcados"><span class="header-section-number">8.6</span> Análisis de patrones de puntos “marcados”</h2>
<p>Como vimos en la sesión teórica, un dataset de patrón de puntos contiene una serie de eventos, que son los objetos de interés (árboles, muestras de suelo, nidos, crímenes). Sin embargo a menudo estos puntos llevan asociada alguna variable de interés, que puede ser numérica (diámetro, pH del suelo…) o categórica (especie, tipo de suelo…). Estas variables se llaman <em>marcas</em> y los objetos que contienen puntos con marcas asociadas se llaman patrones de puntos <em>marcados</em>.</p>
<p>Recordemos que los patrones de puntos tienen propiedades <em>de primer orden</em>, relacionadas con la intensidad (o densidad) de eventos a lo largo y ancho del área de estudio, y propiedades <em>de segundo orden</em>, que hacen referencia a la dependencia espacial entre los eventos.</p>
<p>Al entrar en juego las marcas, el tipo de preguntas que nos podemos hacer cuando tenemos puntos marcados es variado. Por ejemplo: ¿están relacionadas las ocurrencias de un tipo de evento (por ejemplo, una especie) con las de otro? La distribución de uno de los tipos de evento explica la de otro?</p>
<p>Ahora veremos cómo calcular modelos dependientes de la densidad (mediante kernel) para puntos con diferentes marcas, así como las variantes de los principales métodos dependientes de la distancia (funciones <span class="math inline">\(F\)</span>, <span class="math inline">\(G\)</span>, <span class="math inline">\(K\)</span> y <span class="math inline">\(L\)</span>). Pero antes, veamos algo más sobre los ficheros de patrón de puntos marcados:</p>
<section id="marcas-numéricas" class="level3" data-number="8.6.1">
<h3 data-number="8.6.1" class="anchored" data-anchor-id="marcas-numéricas"><span class="header-section-number">8.6.1</span> Marcas numéricas</h3>
<p>Las marcas de un fichero de patrón de puntos pueden ser de tipo numérico o categórico. Si recordamos del inicio, el fichero <code>longleaf</code> contiene valores de diámetro de los árboles, y R ya nos indica que contiene marcas numéricas:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>longleaf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Marked planar point pattern: 584 points
marks are numeric, of storage type  'double'
window: rectangle = [0, 200] x [0, 200] metres</code></pre>
</div>
</div>
<p>Además, ahora podemos acceder a los valores de las marcas dentro de <code>longleaf</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>    longleaf<span class="sc">$</span>marks</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] 32.9 53.5 68.0 17.7 36.9 51.6 66.4 17.7 21.9 25.7 25.5 28.3 11.2 33.8  2.5
 [16]  4.2  2.5 31.2 16.4 53.2 67.3 37.8 49.9 46.3 40.5 57.7 58.0 54.9 25.3 18.4
 [31] 72.0 31.4 55.1 36.0 28.4 24.8 44.1 50.9 47.5 58.0 36.9 65.6 52.9 39.5 42.7
 [46] 44.4 40.3 53.5 44.2 53.8 38.0 48.3 42.9 40.6 34.5 45.7 51.8 52.0 44.5 35.6
 [61] 19.2 43.5 33.7 43.3 36.6 46.3 48.3 20.4 40.5 44.0 40.9 51.0 36.5 42.1 15.6
 [76] 18.5 43.0 28.9 21.3 30.9 42.7 37.6 47.1 44.6 44.3 26.1 25.9 41.4 59.5 26.1
 [91] 11.4 33.4 35.8 54.4 33.6 35.5  7.4 36.6 19.1 34.9 37.3 16.3 39.1 36.5 25.0
[106] 46.8 18.7 23.2 20.4 42.3 38.1 17.9 39.7 14.5 33.5 56.0 66.1 26.3 44.8 24.2
[121] 39.0 15.1 35.6 21.6 17.2 22.3 18.2 55.6 23.3 27.0 50.1 45.5 47.2 37.8 31.9
[136] 38.5 23.8 46.3  2.8  3.2  5.8  3.5  2.3  3.8  3.2  4.4  3.9  7.8  4.7  4.8
[151] 44.1 51.5 51.6 33.3 13.3  5.7  3.3 45.9 32.6 11.4  9.1  5.2  4.9 42.0 32.0
[166] 32.8 22.0 20.8  7.3  3.0  2.2  2.2  2.2 59.4 48.1 51.5 50.3  2.9 19.1 15.1
[181] 21.7 42.4 40.2 37.4 40.1 39.5 32.5 39.5 35.6 44.1 42.2 39.4 35.5 39.1  9.5
[196] 48.4 31.9 30.7 15.0 24.5 15.0 22.2 27.5 10.8 26.2 10.2 18.9 44.2 13.8 16.7
[211] 35.7 12.1 35.4 32.7 30.1 28.4 16.5 12.7  5.5  2.5  3.0  3.2  3.2  4.0  3.6
[226]  3.8  4.3  3.3  6.3 18.4  5.4  5.4 26.0 22.3 35.2 24.1  6.9 61.0 20.6  6.5
[241]  2.8  4.8  5.4  4.3  4.0  3.2  2.8  4.9  3.5  2.9  2.4  3.3  2.1  2.0  3.9
[256]  5.0  2.3  2.2 67.7  2.9  2.4 56.3 39.4 59.5 42.4 63.7 66.6 69.3 56.9 23.5
[271]  9.1 29.9 14.9 38.7 31.5 27.8 28.5 21.6  2.0  2.6  2.3  3.5  3.6  2.6  2.0
[286]  2.0  2.7  2.6  2.2  2.7 30.1 16.6 10.4 11.8 32.3 33.5 30.5 10.5 13.8 22.8
[301] 31.7 10.1 14.5 12.0  2.2  2.3  3.2  3.0 50.6  2.6 50.0 52.2  5.2  5.2  6.7
[316] 14.0 12.7 59.5 52.0 45.9 18.0 43.5  3.3  4.3  7.4 10.1 23.1  8.1  5.7 13.3
[331] 12.8 11.6  6.3 20.0  8.9 27.6  4.5  9.2  2.3  5.0  4.0 21.8 10.9 14.9 45.0
[346] 16.4 43.3 55.6 10.6 45.9 45.2 35.5 43.6 44.6 38.8 34.9 17.0 50.4  2.0 33.8
[361] 51.1 21.8 46.5  5.6 19.6 32.3  3.7  2.7  2.5  2.5  2.4  7.2  7.0 11.8  8.5
[376]  9.5  7.0 10.5  6.6  6.6  8.8 11.6 48.2 36.2 44.9 43.0 37.5 31.5 39.9 35.5
[391] 51.7 36.5 40.2  7.8 17.0 36.4 19.6 15.0 28.8 20.1 39.3 37.9 40.6 33.0 35.7
[406] 20.6 22.0 16.3  5.6  7.4 42.3 43.8 53.0 48.1 41.9 48.0 75.9 40.4 40.9 39.4
[421] 40.9 17.6 17.8  3.7 19.0 11.2 27.6 14.5 34.4 20.0  2.9  7.3 52.7  8.7  3.6
[436]  4.6 11.4 11.0 18.7  5.6  2.1  3.3 11.5  2.6  4.4 18.3  7.5 17.2  4.6 32.0
[451] 56.7 46.0  7.8 54.9 45.5  9.2 13.2 15.3  8.5  2.2 58.8 47.5 52.2 56.3 39.8
[466] 38.1 38.9  9.7  7.4 22.1 16.9  5.9 10.5  9.5 45.9 11.4  7.8 14.4  8.3 30.6
[481] 44.4 38.7 41.5 34.5 31.8 39.7 23.3 37.7 43.0 39.2 40.4 36.7 48.4 27.9 46.4
[496] 38.5 39.4 50.0 51.6 38.7 39.6 29.1 44.0 50.9 50.8 43.0 44.5 29.8 44.3 51.2
[511] 37.7 36.8 33.6 47.9 32.0 40.3 42.5 59.7 44.2 30.9 39.5 48.7 32.8 47.2 42.1
[526] 43.8 30.5 28.3 10.4 15.0  7.4 15.3 17.5  5.0 12.2  9.0  2.4 13.7 13.1 12.8
[541] 27.0  2.6  4.9 35.0 23.7 42.9 14.2  3.3 28.4 10.0  6.4 22.0  4.3 10.0  9.2
[556]  3.7 66.7 68.0 23.1  5.7 11.7 40.4 43.3 60.2 55.5 54.1 22.3 21.4 55.7 51.4
[571] 23.9  5.2  7.6 27.8 49.6 51.0 50.7 43.4 55.6  4.3  2.5 23.5  8.0 11.7</code></pre>
</div>
</div>
<p>Y si ploteamos:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(longleaf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_PatronPuntos_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Vemos que por defecto, el tamaño de los círculos es proporcional a la variable de “marca”, en este caso el diámetro. Podemos cambiar este comportamiento por defecto marcando la opción <code>use.marks</code> a <code>FALSE</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(longleaf, <span class="at">use.marks =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_PatronPuntos_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Aunque se pueden realizar algunos cálculos con ficheros ppp con marcas numéricas, en realidad esto cae más dentro del campo de la autocorrelación espacial, por lo que no lo trataremos aquí.</p>
</section>
<section id="marcas-categóricas" class="level3" data-number="8.6.2">
<h3 data-number="8.6.2" class="anchored" data-anchor-id="marcas-categóricas"><span class="header-section-number">8.6.2</span> Marcas categóricas</h3>
<p>El segundo tipo de marcas posible que podemos encontrar son las marcas categóricas. Es el caso del fichero <code>lansing</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>lansing</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Marked planar point pattern: 2251 points
Multitype, with levels = blackoak, hickory, maple, misc, redoak, whiteoak 
window: rectangle = [0, 1] x [0, 1] units (one unit = 924 feet)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(lansing<span class="sc">$</span>marks)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] blackoak blackoak blackoak blackoak blackoak blackoak
Levels: blackoak hickory maple misc redoak whiteoak</code></pre>
</div>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lansing)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_PatronPuntos_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Por defecto nos separa los distintos niveles de la marca (en este caso la especie) mediante símbolos, pero podemos modificarlo:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lansing, <span class="at">cex =</span> <span class="fl">0.7</span>, <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">bg =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"purple"</span>, <span class="st">"green"</span>, <span class="st">"blue"</span>, <span class="st">"orange"</span>, <span class="st">"yellow"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_PatronPuntos_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>También podemos obviarlo con la opción <code>use.marks = FALSE</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lansing, <span class="at">use.marks =</span> <span class="cn">FALSE</span>, <span class="at">pch =</span><span class="dv">19</span>, <span class="at">cex =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_PatronPuntos_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="crear-objetos-ppp-con-marcas" class="level3" data-number="8.6.3">
<h3 data-number="8.6.3" class="anchored" data-anchor-id="crear-objetos-ppp-con-marcas"><span class="header-section-number">8.6.3</span> Crear objetos ppp con marcas</h3>
<p>Como hemos comentado, las funciones con las que trabajaremos no utilizan ninguno de los formatos de ráster o vectorial que conocemos, sino que utilizan objetos de clase <code>ppp</code> (planar point pattern). Los datasets que usaremos ya vienen en este formato, pero esto no es lo habitual, por lo que en esta sección veremos cómo generar objetos de este tipo a partir de datasets normales.</p>
<p>Un objeto <code>ppp</code> contiene las coordenadas de los puntos y una”ventana” de análisis (área de estudio). Vamos a cargar los datos ya en el formato necesario. En este caso cargaremos los puntos de un fichero separado por comas disponible en el campus virtual, y llamado <code>finland.csv</code>, que contiene la ubicación de árboles de 4 especies en una parcela de 20x20 m en Finlandia.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>finland_trees <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"./data/finland/finland.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Podemos ver que el objeto <code>finland_trees</code> tiene 3 columnas, una contiene las coordenadas X, otra las Y, y el tercero contiene la especie de cada árbol. Podemos observarlo mediante:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(finland_trees)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          x        y species
1 1.9119408 19.52381    pine
2 1.1462073 18.29303    pine
3 0.4761905 16.76923    pine
4 3.5391237 19.11355    pine
5 2.7255319 17.82417    pine
6 2.2469492 16.24175    pine</code></pre>
</div>
</div>
<p>Para crear un objeto <code>ppp</code> necesitamos usar la función <code>ppp()</code>. Si miramos la ayuda de la función (<code>?ppp</code>) vemos que esta función requiere 4 tipos de información: las coordenadas X, las Y, el tamaño de la “ventana” (la región a estudiar) y las marcas, si es que las hay (los valores asociados a cada evento). Vamos a crear un objeto <code>ppp</code> a partir de <code>finland_trees</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>finland <span class="ot">&lt;-</span> <span class="fu">ppp</span>(<span class="at">x =</span> finland_trees<span class="sc">$</span>x, <span class="at">y =</span> finland_trees<span class="sc">$</span>y, </span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">window =</span> <span class="fu">owin</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">20</span>), <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">20</span>), <span class="at">unitname =</span> <span class="st">"meters"</span>),</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">marks =</span> <span class="fu">factor</span>(finland_trees<span class="sc">$</span>species))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Con el código de arriba definimos las coordenadas x e y para el objeto ppp a partir de las columnas del data frame. La parte del código que dice <code>window = owin</code> define el rango de x e y alrededor de los puntos, y el comando <code>marks =</code> define los valores de las marcas, aunque esto último es opcional.</p>
</section>
<section id="análisis-exploratoriodescriptivo" class="level3" data-number="8.6.4">
<h3 data-number="8.6.4" class="anchored" data-anchor-id="análisis-exploratoriodescriptivo"><span class="header-section-number">8.6.4</span> Análisis exploratorio/descriptivo</h3>
<p>¿Cuántos eventos tiene el dataset <code>finland</code>? ¿Cuál es el área de estudio? ¿Cuántas especies diferentes contiene la parcela? ¿Cuál es la densidad relativa de cada una de ellas?</p>
<p>Las dos primeras son preguntas que ya sabemos responder de ejercicios anteriores. Sin embargo ahora vemos que la función <code>summary()</code> nos devuelve información por marcas:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(finland)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Marked planar point pattern:  168 points
Average intensity 0.42 points per square meters

Coordinates are given to 15 decimal places

Multitype:
      frequency  proportion intensity
aspen         1 0.005952381    0.0025
birch        17 0.101190500    0.0425
pine        128 0.761904800    0.3200
rowan        22 0.130952400    0.0550

Window: rectangle = [0, 20] x [0, 20] meters
Window area = 400 square meters
Unit of length: 1 meters</code></pre>
</div>
</div>
<p>Del mismo modo, el plot “normal” puede resultar confuso, pero podemos pedirle que nos represente la distribución de cada tipo de evento (en este caso, cada especie):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(finland)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_PatronPuntos_files/figure-html/unnamed-chunk-58-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">split</span>(finland))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_PatronPuntos_files/figure-html/unnamed-chunk-58-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="efectos-de-primer-orden-dependientes-de-la-densidad" class="level3" data-number="8.6.5">
<h3 data-number="8.6.5" class="anchored" data-anchor-id="efectos-de-primer-orden-dependientes-de-la-densidad"><span class="header-section-number">8.6.5</span> Efectos de primer orden (dependientes de la densidad)</h3>
<p>Vamos a ajustar un análisis de densidad en kernel (ventana móvil para las especies diferentes de las contenidas en nuestra muestra). En realidad es muy sencillo, aprovechando la función <code>split()</code> que hemos visto antes:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(<span class="fu">split</span>(finland)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_PatronPuntos_files/figure-html/unnamed-chunk-59-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>La proporción relativa de la intensidad de cada especie se puede calcular, para hacer que las intensidades estén todas en la misma escala y se puedan comparar los valores:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">relrisk</span>(finland), <span class="at">zlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Negative Likelihood Cross-Validation criterion was minimised at
left-hand end of interval [0.155, 7.07]; use arguments 'hmin', 'hmax' to
specify a wider interval for bandwidth 'sigma'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Numerical underflow detected: sigma is probably too small</code></pre>
</div>
<div class="cell-output-display">
<p><img src="05_PatronPuntos_files/figure-html/unnamed-chunk-60-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Ahora los valores son más comparables entre especies, y vemos de manera muy clara la abundancia de pinos, y los pocos chopos (aspen) que hay. Basado en los mapas de densidad, ¿véis alguna especie que se asocie con otra? ¿Y algún tipo de proceso de segregación entre especies?</p>
</section>
<section id="efectos-de-segundo-orden-dependientes-de-la-distancia" class="level3" data-number="8.6.6">
<h3 data-number="8.6.6" class="anchored" data-anchor-id="efectos-de-segundo-orden-dependientes-de-la-distancia"><span class="header-section-number">8.6.6</span> Efectos de segundo orden (dependientes de la distancia)</h3>
<p>Igual que en los eventos de puntos sin marcas, podemos testar las asociaciones entre los distintos tipos de eventos de manera más formal mediante las funciones <span class="math inline">\(G\)</span>, <span class="math inline">\(F\)</span>, <span class="math inline">\(K\)</span> y <span class="math inline">\(L\)</span>. Para cada una de las funciones vistas antes (<code>Gest</code>, <code>Fest</code>, <code>Kest</code> y <code>Lest</code>) existe su variante de tipo cruzado (cross-type), que compara las distribuciones para dos valores de la variable de marca.</p>
<p>Por ejemplo, para correr un análisis de función G y ver si hay indepencia entre las ubicaciones de pinos y abedules podemos hacer:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">Gcross</span>(finland, <span class="at">i =</span> <span class="st">"birch"</span>, <span class="at">j =</span> <span class="st">"rowan"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_PatronPuntos_files/figure-html/unnamed-chunk-61-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>La interpretación es similar a la que hemos visto hasta ahora, de manera que los valores por debajo de la curva teórica indica segregación entre las especies, mientras que valores por encima indican agrupación.</p>
<p>Nótese que debemos especificar los niveles de la muestra a comparar, si no tomará por defecto los dos primeros (ya que las comparaciones sólo pueden hacerse dos a dos)</p>
<p>También podemos construir los intervalos de confianza de manera análoga:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a> G <span class="ot">&lt;-</span> <span class="fu">envelope</span>(finland, Gcross, <span class="at">i=</span> <span class="st">"birch"</span>, <span class="at">j =</span> <span class="st">"rowan"</span>,</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">nsim =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generating 10 simulations of CSR  ...
1, 2, 3, 4, 5, 6, 7, 8, 9, 
10.

Done.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(G)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_PatronPuntos_files/figure-html/unnamed-chunk-62-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>El resto de funciones asociadas a las propiedades de segundo orden pueden construirse de forma análoga:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Función K</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a> K <span class="ot">&lt;-</span> <span class="fu">envelope</span>(finland, Kcross, <span class="at">i=</span> <span class="st">"birch"</span>, <span class="at">j =</span> <span class="st">"rowan"</span>,<span class="at">nsim =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generating 10 simulations of CSR  ...
1, 2, 3, 4, 5, 6, 7, 8, 9, 
10.

Done.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(K)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_PatronPuntos_files/figure-html/unnamed-chunk-63-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Función L</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>L <span class="ot">&lt;-</span> <span class="fu">envelope</span>(finland, Lcross, <span class="at">i=</span> <span class="st">"birch"</span>, <span class="at">j =</span> <span class="st">"rowan"</span>, <span class="at">nsim =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generating 10 simulations of CSR  ...
1, 2, 3, 4, 5, 6, 7, 8, 9, 
10.

Done.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(L)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_PatronPuntos_files/figure-html/unnamed-chunk-63-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Función de correlación de pares</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">pcfcross</span>(finland))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05_PatronPuntos_files/figure-html/unnamed-chunk-63-3.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="conclusiones" class="level2" data-number="8.7">
<h2 data-number="8.7" class="anchored" data-anchor-id="conclusiones"><span class="header-section-number">8.7</span> Conclusiones</h2>
<p>Hemos visto como analizar patrones de puntos tanto univariantes como multivariantes (con varios niveles), de manera que hemos aprendido a determinar si la distribución de una serie de puntos es aleatoria, agrupada o dispersa, y a comparar las distribuciones de dos especies mediante diversos estadísticos. Por supuesto, esto es sólo la punta del iceberg de la potencialidad de este tipo de análisis, pero supone una buena base que podemos utilizar para analizar diferentes tipos de datos.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./04_AutocorrelacionEspacial.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Autocorrelación espacial</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./06_InterpolacionEspacial.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Interpolación espacial</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Apuntes y ejercicios de geoestadística forestal. Aitor Ameztegui, Universitat de Lleida.</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">Este libro se ha elaborado con <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>



</body></html>